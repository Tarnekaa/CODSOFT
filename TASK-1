# ðŸŽ¬ Movie Genre Classification Project
# Author: Tarnekaa M
# Goal: Predict the genre of a movie based on its plot summary
# Tools: TF-IDF + Logistic Regression (because they're simple and effective!)

# Step 0: Import the cool libraries we need
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import classification_report, accuracy_score

# Step 1: Load the dataset
# Make sure your CSV has 'plot' and 'genre' columns
df = pd.read_csv("movie_genres.csv")  # <-- replace with your dataset path
print("ðŸ“– First few rows of our dataset:\n", df.head())

# Step 2: Separate features and labels
X = df['plot']       # the movie storylines
y = df['genre']      # the genres we want to predict

# Step 3: Split into training and testing sets
# 80% for training, 20% for testing (classic student choice!)
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Step 4: Convert text into numbers using TF-IDF
# TF-IDF = Term Frequency - Inverse Document Frequency
# Basically: "How important is a word in this plot compared to all plots?"
vectorizer = TfidfVectorizer(stop_words='english', max_features=5000)
X_train_tfidf = vectorizer.fit_transform(X_train)
X_test_tfidf = vectorizer.transform(X_test)

# Step 5: Train our classifier
# Logistic Regression is like the "default safe bet" for text classification
model = LogisticRegression(max_iter=1000)
model.fit(X_train_tfidf, y_train)

# Step 6: Test the model
y_pred = model.predict(X_test_tfidf)

# Step 7: Show results
print("âœ… Accuracy of our model:", accuracy_score(y_test, y_pred))
print("\nðŸ“Š Detailed Report:\n", classification_report(y_test, y_pred))
